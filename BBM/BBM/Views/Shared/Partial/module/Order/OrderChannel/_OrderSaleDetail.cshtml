<script src=@Url.Content("~/Scripts/module/Order/OrderChannel/m.Order.js")></script>
<script src=@Url.Content("~/Scripts/module/Order/OrderChannel/mv.OrderSale.js")></script>
<script>
    var Id = '@Html.Raw(ViewBag.OrderId)';
    var valueDiscountFormember = 5;
    var orderSale = new Order.mvOrderSale(Id);
    $(document).ready(function () {
        orderSale.Start();
    });
</script>

<div id="OrderSaleViewIdDetail" class="row-fluid">
    <!--ko template: {name: '_InfoOrder', data: $data } --><!--/ko-->
    <div class="span12 m-20-px m-l-0">
        <table class="table table-striped table-bordered table-hover dataTable">
            <thead>
                <tr>
                    <td>STT</td>
                    <td>Tìm</td>
                    <td>MS</td>
                    <td>Tên</td>
                    <td>Số lượng</td>
                    <td>Giá tiền</td>
                    <!--ko if: IsDisscountbyMark -->
                    <td>Giảm giá cho thành viên</td>
                    <!--/ko-->
                    <th>Thành tiền</th>
                    <td></td>
                </tr>
            </thead>
            <tbody>
                <!--ko foreach:  mOrderSale().Detail() -->
                <tr class="odd">
                    <td class="text-center">
                        <span data-bind="text: ($index() + 1)"></span>
                    </td>
                    <td>
                        <input class="span12" data-bind="value: Keyword" placeholder="Từ khóa tìm kiếm" />
                    </td>
                    <td class="text-center">
                        <span data-bind="text: Code"></span>
                    </td>
                    <td>
                        <span data-bind="text: ProductName"></span>
                    </td>
                    <td>
                        <input data-bind="value: Total, valueUpdate: 'afterkeydown'" class="input-mini" />
                    </td>
                    <td class="text-center">
                        <input data-bind="moneyMaskWithSymbol: Price" class="input-mini" />
                    </td>
                    <!--ko if: $parents[0].IsDisscountbyMark -->
                    <td class="text-center">
                        <label class="text-left">
                            <input type="checkbox" data-bind="checked: isDiscountForMember, value:true">
                            <span class="lbl">Giảm <span data-bind="text:  $parents[0].valueDiscountForMember"></span>%</span>
                        </label>
                    </td>
                    <!--/ko-->
                    <td>
                        <span data-bind="textMoneyDefaultSymbol: TotalMoney"></span>
                    </td>
                    <td>
                        <span class="btn btn-danger btn-small" data-bind="click: $parent.RemoveItem"><i class="icon-remove"></i></span>
                    </td>
                </tr>
                <!-- /ko -->
                <tr class="odd">
                    <td class="text-center"></td>
                    <td>
                        <input class="span12" placeholder="Từ khóa tìm kiếm" data-bind="value: KeywordSearch ,event: { change:EventChangeKeyword }" />
                        <!--ko if:  ListProductSearch().length > 1 -->
                        <div class="search_recommended">
                            <ul>
                                <!--ko foreach: ListProductSearch -->
                                <li data-bind="html: (masp() +' - ' + tensp()), click: $parents[0].GetProduct"></li>
                                <!-- /ko -->
                            </ul>
                        </div>
                        <!-- /ko -->
                    </td>
                    <td class="text-center"></td>
                    <td></td>
                    <td>
                        <input class="input-mini" />
                    </td>
                    <td class="text-center">
                        <input class="input-mini" />
                    </td>
                    <!--ko if: IsDisscountbyMark -->
                    <td class="text-center"></td>
                    <!--/ko-->
                    <td></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        <!--ko if: mOrderSale().Id() -->
        <div class="m-20-px text-center">
            <button class="btn btn-success" data-bind="click: function(){ CreatOrderSale(false)}">Đặt hàng</button>
            <button class="btn btn-primary" data-bind="click: function(){ CreatOrderSale(true)}">Hoàn thành</button>
        </div>
        <!--/ko-->
        <!--ko if: !mOrderSale().Id()-->
        <div class="m-20-px text-center">
            <button class="btn btn-info" data-bind="click: function(){ mOrderSale().Status(2), UpdateOrderSale()}">Đang giao hàng</button>
            <button class="btn btn-warning" data-bind="click: function(){ mOrderSale().Status(5), UpdateOrderSale()}">Hoãn</button>
            <button class="btn btn-warning" data-bind="click: function(){ mOrderSale().Status(6),UpdateOrderSale()}">Giao thất bại</button>
            <button class="btn btn-primary" data-bind="click: function(){ mOrderSale().Status(3),UpdateOrderSale()}">Hoàn thành</button>
            <button class="btn btn-danger" data-bind="click: function(){ mOrderSale().Status(4),UpdateOrderSale()}">Hủy</button>
        </div>
        <!--/ko-->
    </div>
    <!--ko if: mPrintModel -->
    <!--ko template: {name: '_PrintOrder', data: $data } --><!--/ko-->
    <!--/ko-->
</div>